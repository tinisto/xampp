document.addEventListener('DOMContentLoaded',function(){console.log('Header dropdown fix initializing...');setTimeout(function(){initializeDropdowns()},100);function initializeDropdowns(){const dropdownTriggers=document.querySelectorAll('[data-bs-toggle="dropdown"]');console.log('Found dropdown triggers:',dropdownTriggers.length);dropdownTriggers.forEach(function(trigger,index){if(!trigger){console.warn('Null trigger found at index:',index);return}console.log('Setting up trigger:',trigger);trigger.removeEventListener('click',handleDropdownClick);trigger.addEventListener('click',handleDropdownClick)});document.removeEventListener('click',handleOutsideClick);document.addEventListener('click',handleOutsideClick);document.removeEventListener('keydown',handleEscapeKey);document.addEventListener('keydown',handleEscapeKey)}function handleDropdownClick(e){e.preventDefault();e.stopPropagation();const trigger=e.currentTarget;if(!trigger){console.error('No trigger found in click event');return}console.log('Dropdown clicked:',trigger);let dropdown=null;if(trigger.nextElementSibling&&trigger.nextElementSibling.classList&&trigger.nextElementSibling.classList.contains('dropdown-menu')){dropdown=trigger.nextElementSibling}else if(trigger.parentElement&&trigger.parentElement.nextElementSibling&&trigger.parentElement.nextElementSibling.classList&&trigger.parentElement.nextElementSibling.classList.contains('dropdown-menu')){dropdown=trigger.parentElement.nextElementSibling}else if(trigger.parentElement){dropdown=trigger.parentElement.querySelector('.dropdown-menu')}else{const dropdownContainer=trigger.closest('.dropdown');if(dropdownContainer){dropdown=dropdownContainer.querySelector('.dropdown-menu')}}if(!dropdown){console.error('No dropdown menu found for trigger:',trigger);return}console.log('Found dropdown menu:',dropdown);const isShown=dropdown.classList.contains('show')||dropdown.classList.contains('d-block');closeAllDropdowns();if(!isShown){dropdown.classList.add('show');dropdown.style.display='block';trigger.setAttribute('aria-expanded','true');console.log('Dropdown opened')}else{dropdown.classList.remove('show');dropdown.style.display='none';trigger.setAttribute('aria-expanded','false');console.log('Dropdown closed')}}function handleOutsideClick(e){if(!e.target.closest('.dropdown')){closeAllDropdowns()}}function handleEscapeKey(e){if(e.key==='Escape'){closeAllDropdowns()}}function closeAllDropdowns(){const allDropdowns=document.querySelectorAll('.dropdown-menu');allDropdowns.forEach(function(menu){if(menu&&menu.classList){menu.classList.remove('show');menu.style.display='none'}});const allTriggers=document.querySelectorAll('[data-bs-toggle="dropdown"]');allTriggers.forEach(function(trigger){if(trigger&&trigger.setAttribute){trigger.setAttribute('aria-expanded','false')}})}window.reinitializeDropdowns=initializeDropdowns});function checkBootstrap(){if(typeof bootstrap==='undefined'){console.warn('Bootstrap JS is not loaded properly');return false}return true}function initializeDropdowns(){checkBootstrap();const dropdowns=document.querySelectorAll('.dropdown-toggle');dropdowns.forEach(function(dropdown){if(typeof bootstrap!=='undefined'&&bootstrap.Dropdown){new bootstrap.Dropdown(dropdown)}})}