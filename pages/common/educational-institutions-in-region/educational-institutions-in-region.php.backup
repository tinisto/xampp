<?php
require_once $_SERVER['DOCUMENT_ROOT'] . '/common-components/check_under_construction.php';
require_once $_SERVER['DOCUMENT_ROOT'] . '/database/db_connections.php';

// Fetch region data first
include 'fetch-data-from-regions-table.php';

// Determine the type of institution based on the URL
$type = isset($_GET['type']) ? $_GET['type'] : 'spo';

// Set the page title based on the type of institution
switch ($type) {
    case 'schools':
        $pageTitle = 'Школы ' . $myrow_region['region_name_rod'];
        break;
    case 'spo':
        $pageTitle = 'Колледжи / Техникумы ' . $myrow_region['region_name_rod'];
        break;
    case 'vpo':
        $pageTitle = 'Высшие учебные заведения ' . $myrow_region['region_name_rod'];
        break;
    default:
        header("Location: /error");
        exit();
}

// Include the unified template
$mainContent = 'pages/common/educational-institutions-in-region/educational-institutions-in-region-content-modern.php';
$additionalData = [
    'type' => $type,
    'pageTitle' => $pageTitle,
    'region_id' => $region_id,
    'myrow_region' => $myrow_region,
    'region_name_en' => $region_name_en
];

require_once $_SERVER['DOCUMENT_ROOT'] . '/common-components/template-engine-unified.php';
renderTemplate($pageTitle, $mainContent, $additionalData);